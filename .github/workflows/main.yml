name: GitHub Android Stable
on: workflow_dispatch

jobs:
  run-android:
    runs-on: ubuntu-latest
    steps:
      - name: ЁЯМР Connect Tailscale
        uses: tailscale/github-action@v2
        with:
          authkey: ${{ secrets.TAILSCALE_AUTHKEY }}
          args: --hostname=gh-android-stable

      - name: ЁЯЫая╕П Install Emulator & VNC Tools
        run: |
          sudo apt-get update
          sudo apt-get install -y qemu-kvm qemu-system-x86 xvfb x11vnc fluxbox

      - name: ЁЯТ┐ Setup & Auto-Boot Android
        run: |
          # рж╣рж╛рж▓ржХрж╛ ржПржмржВ ржжрзНрж░рзБржд ржЕрзНржпрж╛ржирзНржбрзНрж░рзЯрзЗржб ржЗржорзЗржЬ ржбрж╛ржЙржирж▓рзЛржб
          curl -L -o android.iso "https://sourceforge.net/projects/android-x86/files/Release%209.0/android-x86_64-9.0-r2.iso/download"
          
          # ржнрж╛рж░рзНржЪрзБржпрж╝рж╛рж▓ рж╕рзНржХрзНрж░рж┐ржи рж╢рзБрж░рзБ ржХрж░рж╛
          Xvfb :99 -screen 0 1024x768x16 &
          export DISPLAY=:99
          fluxbox &
          
          # QEMU ржжрж┐рзЯрзЗ ржЕрзНржпрж╛ржирзНржбрзНрж░рзЯрзЗржб рж╕рзНржЯрж╛рж░рзНржЯ (ржПржЯрж┐ ржнрж╛рж░рзНржЪрзБржпрж╝рж╛рж▓ ржмржХрзНрж╕рзЗрж░ ржЪрзЗрзЯрзЗ ржнрж╛рж▓рзЛ ржХрж╛ржЬ ржХрж░рзЗ)
          qemu-system-x86_64 -m 2048 -cdrom android.iso -boot d -net nic -net user -display x11 &
          
          # рзлрзпрзжрзж ржкрзЛрж░рзНржЯрзЗ VNC рж╕рж╛рж░рзНржнрж╛рж░ рж╕рзНржЯрж╛рж░рзНржЯ ржПржмржВ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб рж╕рзЗржЯржЖржк
          mkdir -p ~/.vnc
          x11vnc -storepasswd "android123" ~/.vnc/passwd
          x11vnc -rfbauth ~/.vnc/passwd -display :99 -forever -bg -rfbport 5900

      - name: ЁЯФС Connection Info
        run: |
          echo "=========================================="
          echo "тЬЕ ANDROID IS NOW LIVE!"
          echo "ЁЯМР IP: $(tailscale ip -4)"
          echo "ЁЯФМ Port: 5900"
          echo "ЁЯФС Password: android123"
          echo "=========================================="
          echo "ЁЯТб ржХрж╛ржирзЗржХрзНржЯ ржХрж░рж╛рж░ ржкрж░ рзл рж╕рзЗржХрзЗржирзНржб ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзЗ ENTER ржЪрж╛ржкрзБржиред"
          
          # рж╕рзЗрж╢ржи ржЪрж╛рж▓рзБ рж░рж╛ржЦрж╛рж░ ржЬржирзНржп
          sleep 3600
